# Optical Character Recognition (OCR) - Розпізнавання тексту

## Опис лабораторної

Ця лабораторна робота присвячена **оптичному розпізнаванню символів (OCR)** з фокусом на аналізі якості моделі через матрицю помилок, тренд точності та візуалізацію типових помилок.

Реалізовано:

- **Confusion Matrix (60%)** – побудова та аналіз матриці помилок для всіх 10 класів (цифри 0-9), включаючи нормалізовані версії та per-class метрики.
- **Accuracy Trend (20%)** – графік динаміки точності по епохах навчання з детальним аналізом збіжності.
- **Typical Errors (20%)** – візуалізація та аналіз типових помилок розпізнавання, найпроблемніших пар цифр.

## Використані дані

- **MNIST** – класичний датасет рукописних цифр
  - 60,000 тренувальних зображень
  - 10,000 тестових зображень
  - 10 класів (цифри 0-9)
  - Розмір зображення: 28×28 пікселів (grayscale)

## Структура проєкту

```text
Deep-learning/07-OCR/
│
├── main.py                    # Головний скрипт лабораторної
├── requirements.txt           # Залежності
├── README.md                  # Поточний файл (опис)
├── ВИСНОВКИ.md               # Висновки та аналіз результатів
│
├── data/                      # (опціонально) додаткові дані
│   └── ...
│
├── models/                    # Збережені ваги моделі
│   └── ocr_cnn.h5
│
└── results/                   # Згенеровані результати
    ├── dataset_samples.png
    ├── class_distribution.png
    ├── training_history.csv
    ├── accuracy_trend.png
    ├── accuracy_trend_detailed.png
    ├── confusion_matrix.png
    ├── confusion_matrix_normalized.png
    ├── confusion_matrix.csv
    ├── per_class_metrics.png
    ├── classification_report.csv
    ├── typical_errors_confident.png
    ├── error_pairs_examples.png
    ├── error_patterns.csv
    └── live_ocr_*.jpg
```

## Встановлення

### Вимоги

- Python 3.8+
- pip
- Веб-камера (для live-режиму)
- Бажано GPU, але робота можлива і на CPU

### Встановлення залежностей

```bash
cd Deep-learning/07-OCR

# (Опціонально) створення віртуального середовища
python -m venv venv

# Windows
venv\Scripts\activate
# Linux/Mac
source venv/bin/activate

# Встановлення залежностей
pip install -r requirements.txt
```

## Запуск

```bash
python main.py
```

Після запуску з'являється меню:

- **1** – навчити OCR модель та побудувати **Accuracy Trend (20%)**
- **2** – побудувати **Confusion Matrix (60%)**
- **3** – ілюструвати **типові помилки (20%)**
- **4** – запустити **Live OCR з веб-камери**
- **5** – виконати все послідовно: `1 → 2 → 3`

## Деталі реалізації вимог

### 1. Confusion Matrix (60%)

Матриця помилок є основним інструментом оцінки якості класифікатора:

- **Основна матриця** – показує абсолютні значення правильних і помилкових класифікацій для всіх пар класів
- **Нормалізована по рядках (Recall)** – показує, яка частка кожного справжнього класу була правильно класифікована
- **Нормалізована по стовпцях (Precision)** – показує, яка частка передбачень кожного класу є правильною

Додатково:
- Per-class метрики (Precision, Recall, F1-Score для кожної цифри)
- Кількість помилок по класах
- Топ-10 найчастіших пар помилок
- Розподіл впевненості моделі для правильних і помилкових передбачень

### 2. Accuracy Trend (20%)

Графік тренду точності демонструє динаміку навчання:

- **Основний графік** – Train vs Validation Accuracy по епохах
- **Графік втрат** – Train vs Validation Loss по епохах
- **Індикатор перенавчання** – різниця між train і val accuracy
- **Покращення по епохах** – delta accuracy для кожної епохи
- **Кумулятивний прогрес** – сумарне покращення з початку навчання

### 3. Typical Errors (20%)

Аналіз типових помилок включає:

- **Найвпевненіші помилки** – випадки, де модель помилилася з високою впевненістю
- **Патерни помилок** – статистика найчастіших пар (справжня → передбачена)
- **Приклади по парах** – візуалізація конкретних прикладів для найпроблемніших пар цифр
- **Порівняння впевненості** – середня впевненість для правильних vs помилкових передбачень

## Архітектура CNN моделі

```
Input (28×28×1)
    ↓
Conv2D(32) + BN + Conv2D(32) + BN + MaxPool + Dropout(0.25)
    ↓
Conv2D(64) + BN + Conv2D(64) + BN + MaxPool + Dropout(0.25)
    ↓
Conv2D(128) + BN + Dropout(0.25)
    ↓
Flatten + Dense(256) + BN + Dropout(0.5)
    ↓
Dense(10, softmax)
```

- **Оптимізатор:** Adam (lr=1e-3)
- **Loss:** Sparse Categorical Crossentropy
- **Callbacks:** EarlyStopping, ReduceLROnPlateau

## Live OCR режим

Режим розпізнавання цифр з веб-камери в реальному часі:

1. Захоплення кадру з камери
2. Виділення ROI (region of interest) в центрі кадру
3. Адаптивне порогування для бінаризації
4. Пошук контурів потенційних цифр
5. Нормалізація до 28×28 та розпізнавання моделлю
6. Відображення результатів з confidence score

**Керування:**
- `q` або `ESC` – вихід
- `+`/`-` – збільшити/зменшити поріг впевненості
- `s` – зберегти кадр
- `r` – показати/сховати ROI

## Очікувані результати

На датасеті MNIST модель зазвичай досягає:

| Метрика | Очікуване значення |
|---------|-------------------|
| **Accuracy** | 99.0-99.5% |
| **Precision** | 99.0-99.5% |
| **Recall** | 99.0-99.5% |
| **F1-Score** | 99.0-99.5% |

Типові помилки:
- **4 ↔ 9** – схожі за формою
- **3 ↔ 5** – плутанина через подібність
- **7 ↔ 1** – залежить від стилю написання

## Посилання

- [MNIST Database](http://yann.lecun.com/exdb/mnist/)
- [TensorFlow/Keras Documentation](https://www.tensorflow.org/api_docs/python/tf/keras)
- [Scikit-learn Confusion Matrix](https://scikit-learn.org/stable/modules/generated/sklearn.metrics.confusion_matrix.html)

